<!DOCTYPE html>
<html>
<head>
    <title>CORS Credentials Wildcard Test</title>
</head>
<body>
    <h1>CORS Test: Wildcard Origin + Credentials</h1>
    <p>Checking browser behavior for Access-Control-Allow-Origin: * AND Access-Control-Allow-Credentials: true</p>
    <div id="output"></div>

    <script>
        const url = 'https://httpbin.org/json'; // The URL you are testing

        fetch(url, {
            // This flag is crucial. It tells the browser to include 
            // cookies/auth headers with the cross-origin request.
            credentials: 'include' 
        })
        .then(response => {
            const output = document.getElementById('output');
            
            if (response.ok) {
                // This block should ideally NOT be reached if the server returns 
                // ACAO: * and ACAC: true, because the browser should throw an error.
                output.innerHTML = 'Request Succeeded. Response Status: ' + response.status;
                // Attempt to read the body - this is where the access should be blocked.
                return response.json(); 
            } else {
                output.innerHTML = 'Request failed. Status: ' + response.status;
            }
        })
        .then(data => {
            if (data) {
                document.getElementById('output').innerHTML += '<br><strong>DANGER: Script READ the response data!</strong>';
                console.log("Response Data (unexpected success):", data);
            }
        })
        .catch(error => {
            // This is the EXPECTED outcome for this configuration.
            document.getElementById('output').innerHTML += '<br><strong style="color: green;">Expected CORS Error Caught. Browser blocked access to the response.</strong>';
            console.error("CORS Error:", error.message);
        });
    </script>
</body>
</html>